{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      page: [],\n      state: ' ',\n      isHere: false\n    };\n  },\n  created: function created() {\n    this.loaddata();\n    this.loadstate();\n  },\n  methods: {\n    loaddata: function loaddata() {\n      var _this = this;\n\n      var account = window.sessionStorage.getItem('account');\n      this.$http.get('/queryRecordsByActOrType?account=' + account).then(function (res) {\n        _this.page = res.data;\n      });\n    },\n    loadstate: function loadstate() {\n      var _this2 = this;\n\n      var empId = window.sessionStorage.getItem('empId');\n      this.$http.get('/queryEmpStateById/' + empId).then(function (res) {\n        console.log(res.data);\n\n        if (res.data == 0) {\n          _this2.state = '下班';\n        } else if (res.data == 1) {\n          _this2.state = '在班';\n        } else if (res.data == 2) {\n          _this2.state = '外出';\n        } else if (res.data == 3) {\n          _this2.state = '假期';\n        } else if (res.data == 4) {\n          _this2.state = '请假';\n        }\n\n        if (num == 0) {\n          _this2.isHere = true;\n        } else if (num == 1) {\n          _this2.isHere = false;\n        } else if (num == 2) {\n          _this2.isHere = false;\n        } else if (num == 3) {\n          _this2.isHere = true;\n        }\n      });\n    },\n    formatType: function formatType(row) {\n      if (row.type == 0) {\n        return '上班打卡';\n      } else if (row.type == 1) {\n        return '下班打卡';\n      } else if (row.type == 2) {\n        return '外出打卡';\n      } else if (row.type == 3) {\n        return '返回打卡';\n      }\n    },\n    formatDate: function formatDate(row) {\n      var date = new Date(row.time);\n      var year = date.getFullYear();\n      var month = date.getMonth() + 1;\n      var day = date.getDate();\n      var hour = date.getHours();\n      hour = hour < 10 ? \"0\" + hour : hour;\n      var minute = date.getMinutes();\n      minute = minute < 10 ? \"0\" + minute : minute;\n      var second = date.getSeconds();\n      second = second < 10 ? \"0\" + second : second;\n      return year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second;\n    },\n    changeState: function changeState(num) {\n      var _this3 = this;\n\n      var empId = window.sessionStorage.getItem('empId');\n      this.$http.post('/checkInOrOut/' + empId + '/' + num).then(function (res) {\n        if (res.data) {\n          _this3.$message({\n            message: '操作成功',\n            type: 'success'\n          });\n\n          _this3.loaddata();\n\n          _this3.loadstate();\n\n          if (num == 0) {\n            _this3.isHere = true;\n          } else if (num == 1) {\n            _this3.isHere = false;\n          } else if (num == 2) {\n            _this3.isHere = false;\n          } else if (num == 3) {\n            _this3.isHere = true;\n          }\n        } else {\n          _this3.$message({\n            message: '操作失败',\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACAA,MADA,kBACA;AACA;AACAC,cADA;AAEAC,gBAFA;AAGAC;AAHA;AAKA,GAPA;AAQAC,SARA,qBAQA;AACA;AACA;AACA,GAXA;AAYAC;AACAC,YADA,sBACA;AAAA;;AACA;AACA;AACA;AACA,OAFA;AAGA,KANA;AAOAC,aAPA,uBAOA;AAAA;;AACA;AACA;AACAC;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AAAA,SADA,MAEA;AACA;AAAA,SADA,MAEA;AACA;AAAA,SADA,MAEA;AACA;AAAA;AACA,OArBA;AAsBA,KA/BA;AAgCAC,cAhCA,sBAgCAC,GAhCA,EAgCA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KA1CA;AA2CAC,cA3CA,sBA2CAD,GA3CA,EA2CA;AACA;AACA;AACA;AACA;AACA;AACAE;AACA;AACAC;AACA;AACAC;AACA;AACA,KAvDA;AAwDAC,eAxDA,uBAwDAC,GAxDA,EAwDA;AAAA;;AACA;AACA;AACA;AACA;AACAC,2BADA;AAEAC;AAFA;;AAIA;;AACA;;AACA;AACA;AAAA,WADA,MAEA;AACA;AAAA,WADA,MAEA;AACA;AAAA,WADA,MAEA;AACA;AAAA;AACA,SAfA,MAeA;AACA;AACAD,2BADA;AAEAC;AAFA;AAIA;AACA,OAtBA;AAuBA;AAjFA;AAZA","names":["data","page","state","isHere","created","methods","loaddata","loadstate","console","formatType","row","formatDate","hour","minute","second","changeState","num","message","type"],"sourceRoot":"src/views","sources":["EmployeDaKa.vue"],"sourcesContent":["<template>\r\n<div>\r\n    <el-row>\r\n        <el-col :span='10' >员工状态 {{state}} </el-col>\r\n        <el-col :span=\"12\" style=\"margin-bottom: 10px\">\r\n            <el-button type=\"primary\" @click=\"changeState(0)\" :disabled='isHere'>上班打卡</el-button>\r\n            <el-button type=\"success\" @click=\"changeState(1)\" :disabled='!isHere'>下班打卡</el-button>\r\n            <el-button type=\"danger\" @click=\"changeState(2)\" :disabled='!isHere'>外出打卡</el-button>\r\n            <el-button type=\"warning\" @click=\"changeState(3)\" :disabled='isHere'>返回打卡</el-button>\r\n        </el-col>\r\n    </el-row>\r\n    <el-table\r\n            :data=\"page\"\r\n            border\r\n            style=\"width: 100%\"\r\n            :default-sort = \"{prop: 'time', order: 'descending'}\"\r\n            >\r\n        <el-table-column\r\n            prop=\"name\"\r\n            label=\"用户名\"\r\n        >\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"account\"\r\n            label=\"工号\">\r\n        </el-table-column>\r\n        \r\n        <el-table-column\r\n            prop=\"time\"\r\n            label=\"打卡时间\"\r\n            sortable\r\n            :formatter=\"formatDate\"\r\n            >\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"type\"\r\n            label=\"打卡类型\"\r\n            :formatter=\"formatType\"\r\n            >\r\n        </el-table-column>\r\n    </el-table>\r\n</div>\r\n    \r\n   \r\n</template>\r\n\r\n<style >\r\n</style>\r\n\r\n<script>\r\nexport default {\r\n     data(){\r\n          return{\r\n            page:[],\r\n            state:' ',\r\n            isHere:false\r\n          }\r\n      },\r\n      created(){\r\n        this.loaddata();\r\n        this.loadstate();\r\n      },\r\n      methods:{\r\n        loaddata(){\r\n            var account = window.sessionStorage.getItem('account');\r\n            this.$http.get('/queryRecordsByActOrType?account='+account).then(res => {\r\n                this.page = res.data;\r\n            });\r\n        },\r\n        loadstate(){\r\n            var empId = window.sessionStorage.getItem('empId');\r\n            this.$http.get('/queryEmpStateById/'+empId).then(res => {\r\n                console.log(res.data);\r\n                if (res.data==0){\r\n                    this.state = '下班';\r\n                }else if (res.data==1){\r\n                    this.state = '在班';\r\n                }else if (res.data==2){\r\n                    this.state = '外出';\r\n                }else if (res.data==3){\r\n                    this.state = '假期';\r\n                }else if (res.data==4){\r\n                    this.state = '请假';\r\n                }\r\n                if(num == 0){\r\n                        this.isHere = true;}\r\n                    else if(num == 1){\r\n                        this.isHere = false;}\r\n                    else if(num == 2){\r\n                        this.isHere = false;}\r\n                    else if(num == 3){\r\n                        this.isHere = true;}\r\n            });\r\n        },\r\n        formatType(row){\r\n            if (row.type == 0) {\r\n                return '上班打卡';\r\n            } else if (row.type == 1) {\r\n                return '下班打卡';\r\n            } else if (row.type == 2) {\r\n                return '外出打卡';\r\n            } else if (row.type == 3) {\r\n                return '返回打卡';\r\n            }\r\n        },\r\n        formatDate(row){\r\n            var date = new Date(row.time);\r\n            var year = date.getFullYear();\r\n            var month = date.getMonth()+1;\r\n            var day = date.getDate();\r\n            var hour = date.getHours();\r\n            hour = hour < 10 ? \"0\" + hour : hour;\r\n            var minute = date.getMinutes();\r\n            minute = minute < 10 ? \"0\" + minute : minute;\r\n            var second = date.getSeconds();\r\n            second = second < 10 ? \"0\" + second : second;\r\n            return year+'-'+month+'-'+day+' '+hour+':'+minute+':'+second;\r\n        },\r\n         changeState(num){\r\n            var empId = window.sessionStorage.getItem('empId');\r\n            this.$http.post('/checkInOrOut/'+empId+'/'+num).then(res => {\r\n                if (res.data) {\r\n                    this.$message({\r\n                        message: '操作成功',\r\n                        type: 'success'\r\n                    });\r\n                    this.loaddata();\r\n                    this.loadstate();\r\n                    if(num == 0){\r\n                        this.isHere = true;}\r\n                    else if(num == 1){\r\n                        this.isHere = false;}\r\n                    else if(num == 2){\r\n                        this.isHere = false;}\r\n                    else if(num == 3){\r\n                        this.isHere = true;}\r\n                } else {\r\n                    this.$message({\r\n                        message: '操作失败',\r\n                        type: 'error'\r\n                    });\r\n                }\r\n            });\r\n        },\r\n\r\n      }\r\n }\r\n  </script>\r\n  "]},"metadata":{},"sourceType":"module"}